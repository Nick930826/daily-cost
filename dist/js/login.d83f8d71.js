(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["login"],{"0418":function(e,t,a){"use strict";var n=a("7a23"),r=Object(n["N"])("data-v-81df7ef0");Object(n["A"])("data-v-81df7ef0");var i=Object(n["i"])("div",{class:"block"},null,-1),l=Object(n["i"])("i",{class:"iconfont more"},null,-1);Object(n["y"])();var o=r((function(e,t,a,o,c,u){var s=Object(n["E"])("van-nav-bar");return Object(n["x"])(),Object(n["f"])(n["a"],null,[i,Object(n["i"])(s,{class:"header",onClickLeft:o.back,title:a.title,"left-text":"返回","left-arrow":""},{right:r((function(){return[l]})),_:1},8,["onClickLeft","title"])],64)})),c=a("6c02"),u={name:"Header",props:{title:{type:String,default:""}},setup:function(){var e=Object(c["d"])(),t=function(){e.back()};return{back:t}}};a("a25b");u.render=o,u.__scopeId="data-v-81df7ef0";t["a"]=u},3874:function(e,t,a){"use strict";a("ade9")},"6afa":function(e,t,a){},"81d5":function(e,t,a){"use strict";var n=a("7b0b"),r=a("23cb"),i=a("50c4");e.exports=function(e){var t=n(this),a=i(t.length),l=arguments.length,o=r(l>1?arguments[1]:void 0,a),c=l>2?arguments[2]:void 0,u=void 0===c?a:r(c,a);while(u>o)t[o++]=e;return t}},a25b:function(e,t,a){"use strict";a("6afa")},a55b:function(e,t,a){"use strict";a.r(t);var n=a("7a23"),r=Object(n["N"])("data-v-eaea48b6");Object(n["A"])("data-v-eaea48b6");var i={class:"auth"},l=Object(n["i"])("img",{class:"logo",src:"//s.yezgea02.com/1606836859539/onpeice.png",alt:""},null,-1),o={class:"form"},c={style:{margin:"16px 0"}},u=Object(n["h"])(" 登录 "),s={class:"form"},d={style:{margin:"16px 0"}},b=Object(n["h"])(" 注册 ");Object(n["y"])();var f=r((function(e,t,a,f,p,m){var g=Object(n["E"])("Header"),v=Object(n["E"])("van-field"),h=Object(n["E"])("van-button"),O=Object(n["E"])("van-form"),j=Object(n["E"])("VueImgVerify");return Object(n["x"])(),Object(n["f"])(n["a"],null,[Object(n["i"])(g,{title:"login"==e.type?"登录":"注册"},null,8,["title"]),Object(n["i"])("div",i,[l,"login"==e.type?(Object(n["x"])(),Object(n["f"])(O,{key:0,class:"form-wrap",onSubmit:f.onSubmit},{default:r((function(){return[Object(n["i"])("div",o,[Object(n["i"])(v,{clearable:"",modelValue:e.username,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.username=t}),name:"username",label:"账号",placeholder:"请输入账号",rules:[{required:!0,message:"请填写账户"}]},null,8,["modelValue"]),Object(n["i"])(v,{clearable:"",modelValue:e.password,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.password=t}),type:"password",name:"password",label:"密码",placeholder:"请输入密码",rules:[{required:!0,message:"请填写密码"}]},null,8,["modelValue"])]),Object(n["i"])("div",c,[Object(n["i"])(h,{round:"",block:"",type:"primary","native-type":"submit"},{default:r((function(){return[u]})),_:1}),Object(n["i"])("p",{onClick:t[3]||(t[3]=function(e){return f.chanegType("register")}),class:"change-btn"},"没有账号，前往注册")])]})),_:1},8,["onSubmit"])):Object(n["g"])("",!0),"register"==e.type?(Object(n["x"])(),Object(n["f"])(O,{key:1,class:"form-wrap",onSubmit:f.onSubmit},{default:r((function(){return[Object(n["i"])("div",s,[Object(n["i"])(v,{clearable:"",modelValue:e.username,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.username=t}),name:"username",label:"账号",placeholder:"请输入账号",rules:[{required:!0,message:"请填写账号"}]},null,8,["modelValue"]),Object(n["i"])(v,{clearable:"",modelValue:e.password,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.password=t}),type:"password",name:"password",label:"密码",placeholder:"请输入密码",rules:[{required:!0,message:"请填写密码"}]},null,8,["modelValue"]),Object(n["i"])(v,{center:"",clearable:"",label:"验证码",placeholder:"输入验证码",modelValue:e.verify,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.verify=t})},{button:r((function(){return[Object(n["i"])(j,{ref:"verifyRef"},null,512)]})),_:1},8,["modelValue"])]),Object(n["i"])("div",d,[Object(n["i"])(h,{round:"",block:"",loading:e.loading,type:"primary","native-type":"submit"},{default:r((function(){return[b]})),_:1},8,["loading"]),Object(n["i"])("p",{onClick:t[7]||(t[7]=function(e){return f.chanegType("login")}),class:"change-btn"},"登录已有账号")])]})),_:1},8,["onSubmit"])):Object(n["g"])("",!0)])],64)})),p=a("5530"),m=(a("433b"),a("d399")),g=(a("96cf"),a("1da1")),v={class:"img-verify"};function h(e,t,a,r,i,l){return Object(n["x"])(),Object(n["f"])("div",v,[Object(n["i"])("canvas",{ref:"verify",width:e.width,height:e.height,onClick:t[1]||(t[1]=function(){return r.handleDraw&&r.handleDraw.apply(r,arguments)})},null,8,["width","height"])])}a("99af"),a("cb29");var O={setup:function(){var e=Object(n["C"])(null),t=Object(n["B"])({pool:"ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890",width:120,height:40,imgCode:""});Object(n["u"])((function(){t.imgCode=l()}));var a=function(){t.imgCode=l()},r=function(e,t){return parseInt(Math.random()*(t-e)+e)},i=function(e,t){var a=r(e,t),n=r(e,t),i=r(e,t);return"rgb(".concat(a,",").concat(n,",").concat(i,")")},l=function(){var a=e.value.getContext("2d");a.fillStyle=i(180,230),a.fillRect(0,0,t.width,t.height);for(var n="",l=0;l<4;l++){var o=t.pool[r(0,t.pool.length)];n+=o;var c=r(18,40),u=r(-30,30);a.font=c+"px Simhei",a.textBaseline="top",a.fillStyle=i(80,150),a.save(),a.translate(30*l+15,15),a.rotate(u*Math.PI/180),a.fillText(o,-10,-15),a.restore()}for(var s=0;s<5;s++)a.beginPath(),a.moveTo(r(0,t.width),r(0,t.height)),a.lineTo(r(0,t.width),r(0,t.height)),a.strokeStyle=i(180,230),a.closePath(),a.stroke();for(var d=0;d<40;d++)a.beginPath(),a.arc(r(0,t.width),r(0,t.height),1,0,2*Math.PI),a.closePath(),a.fillStyle=i(150,200),a.fill();return n};return Object(p["a"])(Object(p["a"])({},Object(n["H"])(t)),{},{verify:e,handleDraw:a})}};a("3874");O.render=h;var j=O,y=a("0418"),w=a("a27e"),k=(a("a18c"),{name:"Login",components:{VueImgVerify:j,Header:y["a"]},setup:function(){var e=Object(n["C"])(null),t=Object(n["B"])({username:"",password:"",type:"login",verify:"",imgCode:"",loading:!1}),a=function(){var a=Object(g["a"])(regeneratorRuntime.mark((function a(n){var r,i,l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(a.prev=0,"login"!=t.type){a.next=10;break}return a.next=4,w["a"].post("/user/login",{username:t.username,password:t.password});case 4:r=a.sent,i=r.data,localStorage.setItem("token",i.token),window.location.href="/",a.next=23;break;case 10:if(t.imgCode=e.value.imgCode||"",e.value.imgCode.toLowerCase()==t.verify.toLowerCase()){a.next=15;break}return console.log("verifyRef.value.imgCode",e.value.imgCode),m["a"].fail("验证码错误"),a.abrupt("return");case 15:return t.loading=!0,a.next=18,w["a"].post("/user/register",{username:t.username,password:t.password});case 18:l=a.sent,l.data,m["a"].success("注册成功"),t.type="login",t.loading=!1;case 23:a.next=29;break;case 25:a.prev=25,a.t0=a["catch"](0),console.log(111),t.loading=!1;case 29:case"end":return a.stop()}}),a,null,[[0,25]])})));return function(e){return a.apply(this,arguments)}}(),r=function(e){t.type=e};return Object(p["a"])(Object(p["a"])({},Object(n["H"])(t)),{},{onSubmit:a,chanegType:r,verifyRef:e})}});a("e8e5");k.render=f,k.__scopeId="data-v-eaea48b6";t["default"]=k},a7f7:function(e,t,a){},ade9:function(e,t,a){},cb29:function(e,t,a){var n=a("23e7"),r=a("81d5"),i=a("44d2");n({target:"Array",proto:!0},{fill:r}),i("fill")},e8e5:function(e,t,a){"use strict";a("a7f7")}}]);